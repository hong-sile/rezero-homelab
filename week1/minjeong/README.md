### ν™μ„λ²„λ¥Ό κµ¬μ¶•ν•΄λ³΄μ!

- λ©μ 
    - AWSλ¥Ό μ‚¬μ©ν•λ©΄μ„ μ§μ ‘ μ¨ν”„λ λ―Έμ¤ ν™κ²½μ„ κ²½ν—ν•κ³  μ‹¶μ–΄μ΅λ‹¤.
    - μ¨ν”„λ λ―Έμ¤ ν™κ²½ κ²½ν— + κ°„λ‹¨ν• μ›Ήμ„λ²„ κµ¬μ¶•μ„ λ©ν‘λ΅ μ§„ν–‰ν•λ‹¤.
- ν™κ²½
    - κ·Έλ¨ 2019 λ…ΈνΈλ¶ μ‚¬μ©
    - Proxmox μ„¤μΉ β†’ μ°λ¶„ν¬ VM μƒμ„±

<br>

### Proxmox

- Hypervisor
    - Hypervisorλ” VMμ μƒμ„± λ° κ΄€λ¦¬λ¥Ό λ§΅λ” κ°€μƒν™” μ†ν”„νΈμ›¨μ–΄
    - κ°€μƒν™”: λ¬Όλ¦¬μ μΈ λ¦¬μ†μ¤λ¥Ό κ°€μƒ λ¦¬μ†μ¤λ΅ λ¶„ν• ν•΄ μ‚¬μ©
    - μ„λ²„ κ°€μƒν™” λ°©μ‹: ν• λ€μ λ¬Όλ¦¬μ  ν•λ“μ›¨μ–΄ μ„λ²„ β†’ μ—¬λ¬ λ€μ κ°€μƒ μ„λ²„(VM)λ΅ λ¶„ν• 
- Hypervisor μ ν•
    - 1ν•: νΈμ¤νΈ μ‹μ¤ν… μ„μ— OS μ—†μ΄ λ°”λ΅ μ‹¤ν–‰ β†’ Proxmox
    - 2ν•: νΈμ¤νΈ OS μ„μ—μ„ μ‹¤ν–‰ β†’ VMware, VirtualBox
- κµ¬μ¶•ν•κΈ°
    1. Proxmox iso νμΌ λ‹¤μ΄λ΅λ“
    2. USB λ“λΌμ΄λΈ μ„¤μ •
        - λ¶€ν… κ°€λ¥ν• USB λ“λΌμ΄λΈ λ§λ“¤κΈ°
            - USBμ— iso νμΌμ„ λ„£κ³  rufusλ¥Ό λ‹¤μ΄λ°›μ•„ μ΄λ―Έμ§€λ¥Ό κµ¬μ›€
        - USBμ— Ventoy μ„¤μΉ ν›„ iso νμΌμ„ λ„£μ–΄ μ‚¬μ©ν•κΈ°
            - μ—¬λ¬ μ΄μμ²΄μ λ¥Ό ν•λ‚μ USB λ‚΄μ—μ„ μ„ νƒ κ°€λ¥
    3. μ΄ν›„ BIOSμ— μ§„μ…ν•΄ λ¶€ν… μ°μ„ μμ„λ¥Ό USB λ¶€ν…μΌλ΅ λ³€κ²½ ν›„ Proxmox μ„¤μΉ

- μλ„μ° OS λ° λ°μ΄ν„°κ°€ μ†μ‹¤?
    - λ¬Έμ  μƒν™©: μλ„μ° OSλ¥Ό μ μ§€ν• μƒνƒμ—μ„ Proxmox OSλ¥Ό μ„¤μΉν•λ ¤ ν–λ”λ°, Proxmox μ„¤μΉ ν›„ μλ„μ°κ°€ μ‹¤ν–‰λμ§€ μ•λ”λ‹¤.
    - κ³Όμ •
        1. μλ„μ°μ—μ„ νν‹°μ…μ„ 156GB(μλ„μ°μ©) + 100GB(Proxmoxμ©)μΌλ΅ λ‚λ”
        2. λ¶€ν… μ°μ„ μμ„λ¥Ό USB λ¶€ν…μΌλ΅ λ³€κ²½, ventoyκ°€ μ μ©λ USBμ—μ„ Proxmox iso μ΄λ―Έμ§€λ¥Ό ν†µν•΄ Proxmox μ„¤μΉ
        3. μ΄ν›„ λ¶€ν… μ°μ„ μμ„λ¥Ό μλ„μ° λ¶€νΈ λ§¤λ‹μ €λ΅ λ°”κΏ¨λ”λ°λ„ λ¶κµ¬ν•κ³  μλ„μ°κ°€ μ‹¤ν–‰λμ§€ μ•κ³  proxmoxλ§ μ‹¤ν–‰λ¨
    - μ›μΈ: proxmox μ„¤μΉ κ³Όμ •μ—μ„ β€κΈ°μ΅΄μ λ¨λ“  νν‹°μ…κ³Ό λ°μ΄ν„°κ°€ μ†μ‹¤λ¨β€ λ¬Έκµ¬ ν™•μΈ
        - μ„¤μΉ κ³Όμ •μ—μ„ νν‹°μ… κ²½κ³„ μ‚­μ  β†’ μλ„μ° os λ° λ°μ΄ν„° μ‚­μ 
        - μλ„μ°λ” μ‚­μ λμ–΄λ„ BIOSμ—λ” μλ„μ° λ¶€νΈ λ§¤λ‹μ €κ°€ λ‚¨μ•„μμ„ μ μμ

<br>

### Tailscale

- VPN(Virtual Private Network, κ°€μƒ μ‚¬μ„¤λ§)
    - μ‚¬μ„¤λ§ κµ¬μ¶•
        - μ „μ©λ§ κµ¬μ¶•
        - μΈν„°λ„·(κ³µμ¤‘λ§)μ„ μ‚¬μ©ν•΄ μ‚¬μ„¤λ§κ³Ό κ°™μ€ ν™κ²½ κµ¬μ¶• = κ°€μƒ μ‚¬μ„¤λ§
    - μΈν„°λ„·(κ³µμ¤‘λ§) μƒμ—μ„ κµ¬μ¶•λλ” λ…Όλ¦¬μ μΈ μ „μ©λ§ β†’ κ°€μƒμ ν„°λ„ μ‚¬μ©
- VPN μ ν•
    - Client-to-Site
        - μ‚¬μ©μκ°€ VPN ν΄λΌμ΄μ–ΈνΈλ¥Ό ν†µν•΄ VPN μ„λ²„μ— μ—°κ²° μ”μ²­
        - μ‚¬μ©μ β†’ VPN Client β†’ ISP β†’ VPN Server β†’ Internet
            - μ‚¬μ©μ β†’ ISP β†’ VPN ServerκΉμ§€ ν„°λ„λ§ μƒμ„±
            - ISPλ” νΈλν”½ ν™•μΈ λ¶κ°€
            - μ‚¬μ©μκ°€ VPN μ„λ²„λ΅ λ³΄λ‚Έ λ¨λ“  νΈλν”½μ΄ μ•”νΈν™”
            - VPN μ„λ²„λ” μ‚¬μ©μμ νΈλν”½μ„ λ³µνΈν™”ν•΄ μΈν„°λ„· μƒμΌλ΅ νΈλν”½ μ „λ‹¬
    - Site-to-Site
        - λ‘ λ„¤νΈμ›ν¬ κ°„ μ—°κ²°
    - m2m(machine to machine)
- Tailscale
    - WireGuard ν”„λ΅ν† μ½ κΈ°λ° Mesh VPN
    - m2m VPN
    - Zero Trust λ³΄μ•: λ„¤νΈμ›ν¬ λ‚΄λ¶€/μ™Έλ¶€μ™€ λ¬΄κ΄€ν•κ² ν•­μƒ μ‹ λΆ°ν•μ§€ μ•μ
- Tailscale μ‚¬μ©
    - ν™μ„λ²„ λ° μ›κ²© μ ‘μ†ν•  λ…ΈνΈλ¶μ— λ¨λ‘ Tailscaleμ„ μ„¤μΉν•λ‹¤.
    - μ„¤μΉ ν›„ Tailscaleμ—μ„ IPλ¥Ό ν™•μΈν•λ‹¤.
    - IPμ™€ 8006 ν¬νΈλ¥Ό ν†µν•΄ Proxmox νμ΄μ§€λ΅ μ§„μ…ν•λ‹¤.

<br><hr><br>

### Network

- Bridge
    - VMμ΄ λ…λ¦½μ μΈ IPλ΅ λ™μ‘
- Host-Only
    - μ™Έλ¶€ λ„¤νΈμ›ν¬μ™€ κ²©λ¦¬λ λ‚΄λ¶€ νμ‡„λ§ κµ¬μ„±
- NAT
    - νΈμ¤νΈκ°€ NAT μ—­ν• 
    - VMμ΄ λ‚΄λ¶€ IP μ£Όμ† μ‚¬μ©
    - λ¨λ“  VMμ— κ°™μ€ IP ν• λ‹Ή

|  | Bridge | Host-Only | NAT |
| --- | --- | --- | --- |
| νΈμ¤νΈ - VM | β… | β… | π”Ί |
| VM - VM | β… | β… | β |
| μΈν„°λ„· | β… | β | β… |

<br>

### DHCP

- DHCP(Dynamic Host Configuration Protocol)
    - λ„¤μ„ μ„λ²„ μ£Όμ†, IP μ£Όμ†, κ²μ΄νΈμ›¨μ΄ μ£Όμ†λ¥Ό μλ™ ν• λ‹Ή
    - μκµ¬μ μΈ ν• λ‹Ήμ΄ μ•„λ‹ μ„λ€ κ°λ…μ ν• λ‹Ή
        - dhclient.leases νμΌμ— μ„λ€λ°›μ€ IP λ€μ—­μ΄ κΈ°λ΅λμ–΄ μμ
    - DHCP μ„λ²„ + ν΄λΌμ΄μ–ΈνΈλ΅ κµ¬μ„±
    - λΌμ°ν„°(κ³µμ κΈ°) λ‚΄μ— DHCP μ„λ²„ λ‚΄μ¥ - μΈν„°λ„·μ„ μ‚¬μ©ν•λ” κΈ°κ³„μ— DHCP ν΄λΌμ΄μ–ΈνΈ λ‚΄μ¥
- κµ¬μ¶• κ³Όμ •
    - μ°λ¶„ν¬ OSλ¥Ό μ‚¬μ©ν•λ” VM 2λ€λ¥Ό μ‚¬μ©ν•μ—¬ κ°κ° DHCP μ„λ²„, ν΄λΌμ΄μ–ΈνΈλ΅ κµ¬μ¶•ν•λ‹¤.
    - DHCP μ„λ²„λ” DHCP ν¨ν‚¤μ§€(isc-dhcp-server) μ„¤μΉ λ° μ„¤μ •, κ³ μ • IP ν• λ‹Ήμ΄ ν•„μ”ν•λ‹¤.
    
<details>
<summary>κµ¬μ¶•</summary>
<div markdown="1">

- DHCP μ„λ²„
    - DHCP ν¨ν‚¤μ§€ μ„¤μΉ
        
        ```bash
        sudo apt-get update
        sudo apt-get install isc-dhcp-server
        ```
        
    - κ³ μ • IP ν• λ‹Ή ν•„μ”
        
        ```bash
        vim /etc/netplan/00-installer-config.yaml
        ```
        
        ```yaml
        network:
            version: 2
            ethernets:
            ens18:
                addresses: [192.168.1.20/24]
                routes:
                    - to: default
                    via: 192.168.1.1
                nameservers:
                    addresses: [8.8.8.8, 8.8.4.4]
        ```
        
        ```bash
        sudo netplan apply
        ```
        
    - DHCP μ„¤μ •
        - dhcpd.conf μ„¤μ •
            
            ```bash
            sudo vim /etc/dhcp/dhcpd.conf
            ```
            
            ```bash
            # option domain-name λ¶€λ¶„ μ£Όμ„ μ²λ¦¬
            
            subnet 192.168.0.0 netmask 255.255.255.0 {
                range 192.168.0.2 192.168.0.254;
                option routers 192.168.0.1;
                option subnet-mask 255.255.255.0;
            }
            ```
            
        - NIC μ„¤μ •
            
            ```bash
            vim /etc/default/isc-dhcp-server
            ```
            
            ```bash
            INTERFACESv4="ens18"
            INTERFACESv6="ens18"
            ```
            
    - DHCP μ„λ²„ μ¬μ‹μ‘
        
        ```bash
        sudo systemctl start isc-dhcp-server
        ```
        
    
- DHCP ν΄λΌμ΄μ–ΈνΈ
    - dchp μ„λ²„λ΅λ¶€ν„° IPλ¥Ό ν• λ‹Ήλ°›λ„λ΅ μ„¤μ •
        
        ```bash
        vim /etc/netplan/00-installer-config.yaml
        ```
        
        ```yaml
        network:
            version: 2
            ethernets:
            ens18:
                dhcp4: true
        ```
        
        ```bash
        sudo netplan apply
        ```
        
    - dhcp μ„λ²„λ΅λ¶€ν„° IP κ°±μ‹ 
        
        ```bash
        sudo dhclient -r ens18
        sudo dhclient ens18
        ```
        

- ν΄λΌμ΄μ–ΈνΈκ°€ μƒλ΅μ΄ IP κ°’μ΄ μ•„λ‹ κΈ°μ΅΄μ IP κ°’μ„ κ³„μ† λ°›μ•„μ΄
    - DHCP λ¦¬μ¤ νμΌμ„ μ‚­μ  β†’ μƒλ΅μ΄ IP κ°’μ„ λ°›μ•„μ΄
        
        ```bash
        sudo rm /var/lib/dhcp/dhclient.leases
        ```
</div>
</details>